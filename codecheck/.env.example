# ============================================================================
# CodeCheck - Root Environment Configuration
# ============================================================================
# This file is loaded by docker-compose.yml for container orchestration.
# Copy this file to .env and fill in your actual values.
#
# Note: The api/.env file contains additional application-specific settings.
# This root .env file focuses on Docker Compose and infrastructure settings.
# ============================================================================

# ----------------------------------------------------------------------------
# Database Configuration
# ----------------------------------------------------------------------------
DB_NAME=codecheck
DB_USER=postgres
DB_PASSWORD=CHANGE_THIS_TO_A_SECURE_PASSWORD
DB_PORT=5432

# PostgreSQL Performance Tuning (Optional)
POSTGRES_SHARED_BUFFERS=256MB
POSTGRES_MAX_CONNECTIONS=100

# ----------------------------------------------------------------------------
# Security Secrets
# ----------------------------------------------------------------------------
# Generate using: python3 -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET_KEY=CHANGE-THIS-IN-PRODUCTION-USE-LONG-RANDOM-STRING
SESSION_SECRET=CHANGE-THIS-IN-PRODUCTION-USE-LONG-RANDOM-STRING

# ----------------------------------------------------------------------------
# Anthropic Claude API
# ----------------------------------------------------------------------------
# Get your API key from: https://console.anthropic.com/
CLAUDE_API_KEY=sk-ant-your-api-key-here
CLAUDE_MODEL=claude-3-5-sonnet-20241022
CLAUDE_MAX_TOKENS=4096

# ----------------------------------------------------------------------------
# Redis Configuration
# ----------------------------------------------------------------------------
REDIS_PORT=6379
REDIS_PASSWORD=

# ----------------------------------------------------------------------------
# Application Settings
# ----------------------------------------------------------------------------
ENVIRONMENT=development
DEBUG=false
LOG_LEVEL=INFO

# API Server
API_PORT=8000
API_WORKERS=1

# CORS Origins (comma-separated)
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# ----------------------------------------------------------------------------
# Rate Limiting
# ----------------------------------------------------------------------------
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
AI_RATE_LIMIT_PER_MINUTE=10

# ----------------------------------------------------------------------------
# Feature Flags
# ----------------------------------------------------------------------------
FEATURE_AUTH_ENABLED=true
FEATURE_AI_EXPLANATIONS=true

# ----------------------------------------------------------------------------
# Docker Configuration
# ----------------------------------------------------------------------------
# User/Group IDs for non-root container execution
UID=1000
GID=1000

# Python version for API build
PYTHON_VERSION=3.11

# Volume mount mode (rw for development, ro for production)
VOLUME_MODE=rw

# Uvicorn reload flag (--reload for dev, empty for production)
UVICORN_RELOAD=--reload

# ----------------------------------------------------------------------------
# iOS App Configuration (Optional)
# ----------------------------------------------------------------------------
IOS_API_BASE_URL=http://localhost:8000

# ============================================================================
# QUICK START GUIDE
# ============================================================================
#
# 1. Copy this file:
#    cp .env.example .env
#
# 2. Generate secrets:
#    python3 -c "import secrets; print('JWT_SECRET_KEY=' + secrets.token_urlsafe(32))"
#    python3 -c "import secrets; print('DB_PASSWORD=' + secrets.token_urlsafe(24))"
#
# 3. Get Claude API key:
#    https://console.anthropic.com/
#
# 4. Update .env file with generated values
#
# 5. Start services:
#    docker-compose up -d
#
# ============================================================================